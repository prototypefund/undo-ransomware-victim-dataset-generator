import numpy as np
import matplotlib.pyplot as plt

families = {}

f = open("all.labels", "r")
line = f.readline()

# read labels and build families dict
for line in f.readlines():
    values = line.strip().split('\t')
    if "SINGLETON" not in values[1]:
        try:
            families[values[1]] = families[values[1]] + 1
        except KeyError:
            families[values[1]] = 1
f.close()

# filter families: only collections of ransomware with more than 100 samples are families
families = {k: v for k, v in families.iteritems() if v > 100}

bars = []
height = []

for key in families:
    bars.append(key)

for value in families.values():
    height.append(value)

print "Number of families: " + str(len(families))
 
y_pos = np.arange(len(bars))

plt.xlabel("Number of samples")
plt.ylabel("Ransomware family name")

# create bars
barh = plt.barh(y_pos, height, 0.8)
 
# create names on the x-axis
plt.yticks(y_pos, bars)

for y, x in enumerate(height):
    plt.annotate(str(x), xy=(x, y), va='center')
 
# show graphic
plt.show()